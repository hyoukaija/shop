{extend name="public/base"}

{block name="mycss"}
<style type="text/css">
    .warp {
        padding-top: 1.5rem;
    }

    .add_shop_car {
        width: 20px;
    }
    .page-footer {
        display: none;
    }

    input:checked {
        background-color: #00cc7d;
        color: #fff;
    }
    .ra3 {
        height: 1.3rem; line-height: 1.3rem; margin-right: 2%; margin-bottom: 2%; width: 25%; text-align: center; float: left; background-color: #f5f5f5; color: #333333; font-size: .45rem;
    }
    .curli {
        background-color: #00cc7d; color: #fff;
    }

    .footerone {
        z-index: 30;
    }
    .am-modal-active {
        z-index: 90;
    }
    table tr:nth-child(odd) {
        background-color: #F5F5F5;
    }

    table tr:nth-child(even) {
        background-color: #fff;
    }

    .my_table {
        margin: auto;
        margin-top: 30px;
        width: 90%;
    }
    td {
        padding: 5px;
        height: 35px;
    }
    .bottom_input {
        bottom: 20px;
    }

    .dot {
        position: relative;
        top: -30px;
        cursor:pointer;
        height: 13px;
        width: 13px;
        margin: 0 2px;
        background-color: #bbb;
        border-radius: 50%;
        display: inline-block;
        transition: background-color 0.6s ease;
    }
    .active, .dot:hover {
        background-color: #717171;
    }


.my-pagination { }
.my-pagination .swiper-pagination-bullet { text-align: center; border-radius: 0; opacity: 1; }
.my-pagination ul { display: -webkit-box; }
.my-pagination li { display: block; background: #fff; overflow: hidden; box-flex: 1; -moz-box-flex: 1; -webkit-box-flex: 1; height: 40px; line-height: 40px; position: relative; font-size: 16px; }
.my-pagination li:after { position: absolute; top: auto; right: auto; bottom: 0; left: 0; z-index: 1; display: block; width: 100%; height: 1px; content: ''; background-color: #dcdcdc; -webkit-transform-origin: 50% 100%; transform-origin: 50% 100%; -webkit-transform: scaleY(.5) }
.my-pagination .swiper-pagination-bullet-active { color: #21a4f4; }
.my-pagination .swiper-pagination-bullet-active:after { opacity: 1; background-color: #21a4f4; height: 4px; }
</style>
{/block}

{block name="content"}
<div class="swiper-container">
    <div class="my-pagination mui-bar mui-bar-nav">
        <a class="btn" href="javascript:history.go(-1)">
            <i class="iconfont icon-fanhui"></i>
        </a>
        <ul class="my-pagination-ul top-sch-box top-sch-boxtwo flex-col"></ul>
        <a class="btn" href="{:url('/customer/shopcar/index')}">
            <i class="iconfont icon-gouwuche"></i>
            <span id="calcType">{:$calcType}</span>
        </a>
    </div>
    
    <div class="swiper-wrapper warp warptwo clearfloat">
        <div class="swiper-slide">
            <div class="detail clearfloat">
                <!--banner star-->
                <div class="banner">
                    <div class="slideshow-container">
                        <div class="mySlides fade">
                            <img src="__CUSTOMER__items/{$item->title}/{$item->pic_url_01}" style="width:100%">
                        </div>

                        <div class="mySlides fade">
                            <img src="__CUSTOMER__items/{$item->title}/{$item->pic_url_02}" style="width:100%">
                        </div>

                        <div class="mySlides fade">
                            <img src="__CUSTOMER__items/{$item->title}/{$item->pic_url_03}" style="width:100%">
                        </div>
                        <div class="mySlides fade">
                            <img src="__CUSTOMER__items/{$item->title}/{$item->pic_url_04}" style="width:100%">
                        </div>
                    </div>
                    <div style="text-align:center">
                        <span class="dot" onclick="currentSlide(1)"></span> 
                        <span class="dot" onclick="currentSlide(2)"></span> 
                        <span class="dot" onclick="currentSlide(3)"></span>
                        <span class="dot" onclick="currentSlide(4)"></span> 
                    </div>
                   <!--  <div class="swiper-wrapper">
                        <div class="swiper-slide"><a href="javascript:void(0)"><img class="swiper-lazy" data-src="__CUSTOMER__items/{$item->title}/{$item->pic_url_01}" alt=""></a></div>
                        <div class="swiper-slide"><a href="javascript:void(0)"><img class="swiper-lazy" data-src="__CUSTOMER__items/{$item->title}/{$item->pic_url_02}" alt=""></a></div>
                        <div class="swiper-slide"><a href="javascript:void(0)"><img class="swiper-lazy" src="__CUSTOMER__items/{$item->title}/{$item->pic_url_03}" alt=""></a></div>
                        <div class="swiper-slide"><a href="javascript:void(0)"><img class="swiper-lazy" src="__CUSTOMER__items/{$item->title}/{$item->pic_url_04}" alt=""></a></div>
                    </div> -->
                    <!-- <div class="swiper-pagination"></div> -->
                </div>
                <!--banner end-->
                <div class="top clearfloat box-s">
                    <div class="shang clearfloat">
                        <div class="zuo clearfloat fl over2 box-s">
                            {:$item->title}
                        </div>
                        <div class="you clearfloat fr">
                            <i class="iconfont icon-fenxiang"></i>
                            <p>分享</p>
                        </div>
                    </div>
                    <div class="xia clearfloat">
                        <p class="jifen fl box-s"><samp>{:$item->price}</samp>元原价<samp>／{:$item->no_profit_price}</samp>元成本价</p>
                        <span class="fr">销量8件</span>
                    </div>
                </div>
                <div class="middle clearfloat box-s">
                    <a href="#">
                        <span class="fl">商品详情</span>
                        <i class="iconfont icon-jiantou1 fr"></i>
                    </a>
                </div>
                <div class="middle clearfloat box-s">
                    <a href="#">
                        <span class="fl">商品评价</span>
                        <i class="iconfont icon-jiantou1 fr"></i>
                    </a>
                </div>
            </div>
        </div>

        <div class="swiper-slide">
            <table border="1" class="my_table">
                <tr>
                    <th>属性</th>
                    <th>值</th>
                </tr>
                <tr>
                    <td>商品名称</td>
                    <td>{:$item->title}</td>
                </tr>
                <tr>
                    <td>详细描述</td>
                    <td>{:$item->details}</td>
                </tr>
                <tr>
                    <td>产地</td>
                    <td>{:$item->made_in}</td>
                </tr>
                <tr>
                    <td>重量</td>
                    <td>{:$item->weight}</td>
                </tr>
                <tr>
                    <td>开始销售日期</td>
                    <td>{:$item->release_time}</td>
                </tr>
                <tr>
                    <td>卖点</td>
                    <td>{:$item->keywords}</td>
                </tr>
            </table>
        </div>

        <div class="swiper-slide">
                
        </div>

        <div class="swiper-slide">
            
        </div>

    </div>
    <!--footerone star-->
    <div class="footerone clearfloat">
        <div class="left clearfloat fl">
            <ul>
                <li>
                    <a href="{:url('/customer/index/index')}">
                        <i class="iconfont icon-shangcheng"></i>
                        <p>商城</p>
                    </a>
                </li>
                <li>
                    <a href="#">
                        <i class="iconfont icon-kefu1"></i>
                        <p>客服</p>
                    </a>
                </li>               
            </ul>
        </div>
        <div class="right clearfloat fl">
            <span class="btn fl" onClick="toshopcar()">加入购物车</span>
            <span class="btn btnone fl" onClick="toOrder()">立即购买</span>
        </div>
    </div>
    <!--footerone end-->

    <!--这里是弹出购物车内容-->
    <div class="am-share shopcar">
        <div class="am-share-footer"><button class="share_btn"><img src="__CUSTOMER__img/chahao.png"/></button></div>
        <form method="post" id="shopcar_form" action="{:url('/customer/item/addshopcar')}">
            <div class="am-share-sns box-s">
                <div class="sdetail clearfloat">
           
                    {:token()}
                    <input type="hidden" name="id" value="{:$item->id}">
                    <input type="hidden" name="title" value="{:$item->title}">
                    <div class="top clearfloat">
                        <div class="tu clearfloat fl">
                            <span></span>
                            <img src="__CUSTOMER__upload/22.jpg"/>
                        </div>
                        <div class="you clearfloat fl">
                            <p class="tit">{:$item->title}</p>
                            <span>{:$item->no_profit_price}</span>
                        </div>
                    </div>
                    <div class="middle clearfloat">
                        <p>贩卖价</p>
                        <div class="xia clearfloat">
                            <!-- <ul>
                                <li class="ra3 cur" name="color">金色</li>
                                <li class="ra3" name="color">灰色</li>
                            </ul> -->
                            <input type="text" name="sell_price" style="width: 80%" required>
                        </div>                  
                    </div>
                    <div class="middle clearfloat">
                        <p>颜色分类</p>
                        <div class="xia clearfloat">
                                <label class="ra3"><input style="display: none;" class="ra3" type="radio" name="color" value="gold">金色</label>
                                <label class="ra3"><input style="display: none;" type="radio" name="color" value="pink">金色灰色</label>
                        </div>                  
                    </div>
                    <!-- <div class="middle clearfloat">
                        <p>机身内存</p>
                        <div class="xia clearfloat">
                            <ul>
                                <li class="ra3 cur">128G</li>
                                <li class="ra3">16G</li>
                            </ul>
                        </div>                  
                    </div> -->
                    <div class="bottom clearfloat">
                        <p class="fl">购买数量</p>
                        <div class="you clearfloat fr">
                            <ul>
                                <li id="down"><img src="__CUSTOMER__img/jian.jpg"/></li>
                                <li id="number">1</li>
                                <input type="hidden" id="input_car" name="number" value="1">
                                <li id="add"><img src="__CUSTOMER__img/jia.jpg"/></li>
                            </ul>
                        </div>
                    </div>
            
                </div>
            </div>
            <span class="shop-btn db" id="shopcar_baocun">确定</span>
        </form>
    </div>
    
    <!--这里是弹出下单前确认内容-->
    <div class="am-share order">
        <div class="am-share-footer"><button class="share_btn"><img src="__CUSTOMER__img/chahao.png"/></button></div>
        <form id="order_form" method="post" action="{:url('/customer/order/confirm')}">
            <div class="am-share-sns box-s">
                <div class="sdetail clearfloat">
           
                    {:token()}
                    <input type="hidden" name="id" value="{:$item->id}">
                    <input type="hidden" name="title" value="{:$item->title}">
                    <div class="top clearfloat">
                        <div class="tu clearfloat fl">
                            <span></span>
                            <img src="__CUSTOMER__upload/22.jpg"/>
                        </div>
                        <div class="you clearfloat fl">
                            <p class="tit">{:$item->title}</p>
                            <span>{:$item->no_profit_price}</span>
                        </div>
                    </div>
                    <div class="middle clearfloat">
                        <p>贩卖价</p>
                        <div class="xia clearfloat">
                            <!-- <ul>
                                <li class="ra3 cur" name="color">金色</li>
                                <li class="ra3" name="color">灰色</li>
                            </ul> -->
                            <input type="text" name="sell_price" style="width: 80%" required>
                        </div>                  
                    </div>
                    <div class="middle clearfloat">
                        <p>颜色分类</p>
                        <div class="xia clearfloat">
                                <label class="ra3"><input style="display: none;" class="ra3" type="radio" name="color" value="gold">金色</label>
                                <label class="ra3"><input style="display: none;" type="radio" name="color" value="pink">金色灰色</label>
                        </div>                  
                    </div>
                    <!-- <div class="middle clearfloat">
                        <p>机身内存</p>
                        <div class="xia clearfloat">
                            <ul>
                                <li class="ra3 cur">128G</li>
                                <li class="ra3">16G</li>
                            </ul>
                        </div>                  
                    </div> -->
                    <div class="bottom clearfloat">
                        <p class="fl">购买数量</p>
                        <div class="you clearfloat fr">
                            <ul>
                                <li id="down_order"><img src="__CUSTOMER__img/jian.jpg"/></li>
                                <li id="number_order">1</li>
                                <input type="hidden" id="input_order" name="number" value="1">
                                <li id="add_order"><img src="__CUSTOMER__img/jia.jpg"/></li>
                            </ul>
                        </div>
                    </div>
            
                </div>
            </div>
            <span class="shop-btn db" id="order_baocun">确定</span>
        </form>
    </div>
</div>
    

    
    
    
{/block}

{block name="myjs"}
<script type="text/javascript" src="__CUSTOMER__js/shopcar.js"></script> 
<script type="text/javascript">
    
    $('#down').click(function(){
        var val = parseInt($('#number').text());
        if(val <= 1) {
            $('#number').text(1);
        } else {
            $('#number').text(val - 1);
        }
        $('#input_car').val($('#number').text());
    });
    $('#add').click(function(){
        $('#number').text(parseInt($('#number').text())+1);
        $('#input_car').val($('#number').text());
    });

    $('#down_order').click(function(){
        var val = parseInt($('#number_order').text());
        if(val <= 1) {
            $('#number_order').text(1);
        } else {
            $('#number_order').text(val - 1);
        }
        $('#input_order').val($('#number_order').text());
    });
    $('#add_order').click(function(){
        $('#number_order').text(parseInt($('#number_order').text())+1);
        $('#input_order').val($('#number_order').text());
    });

    var mySwiper = new Swiper('.swiper-container',{
    pagination: '.my-pagination-ul',
    paginationClickable: true,
    // touchMoveStopPropagation : false,
    paginationBulletRender: function (index, className) {
    switch (index) {
      case 0: name='商品';break;
      case 1: name='详情';break;
      case 2: name='评价';break;
      case 3: name='库存';break;
      default: name='';
    }
          return '<li class="' + className + '">' + name + '</li>';
      }
    });

    $('#order_baocun').click(function(){
        $('#order_form').submit();
    });

    $('#shopcar_baocun').click(function(){
        $.ajax({
            type:"POST",
            datatype: 'text',
            async: false,
            url: "{:url('/customer/item/addshopcar')}",
            data: $('#shopcar_form').serializeArray(),
            success: function(data){
                var res = eval('('+data+')');
                console.log(res.status);
                if(res.status == 0){
                    alert(res.msg);
                }
                $(".shopcar").removeClass("am-modal-active");   
                setTimeout(function(){
                    $(".sharebg-active").removeClass("sharebg-active"); 
                    $(".sharebg").remove(); 
                },300);
            }
        });
        $.ajax({
            type:"GET",
            url: "{:url('/customer/item/ajax_detail')}",
            success: function(data){
                var res = eval('('+data+')');
                $('#calcType').text(res.calcType);
            }
        });

    });

    var slideIndex = 0;
    showSlides();

    function showSlides() {
        var i;
        var slides = document.getElementsByClassName("mySlides");
        var dots = document.getElementsByClassName("dot");
        for (i = 0; i < slides.length; i++) {
           slides[i].style.display = "none";  
        }
        slideIndex++;
        if (slideIndex > slides.length) {slideIndex = 1}    
        for (i = 0; i < dots.length; i++) {
            dots[i].className = dots[i].className.replace(" active", "");
        }
        slides[slideIndex-1].style.display = "block";  
        dots[slideIndex-1].className += " active";
        setTimeout(showSlides, 4000); // 切换时间为 4 秒
    }
</script>
{/block}
