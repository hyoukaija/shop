{extend name="public/base"}


{block name="seo"}

<title>{$title|default='页面标题'}</title>
<meta name="keywords" content="{$keywords|default='页面关键字'}">
<meta name="description" content="{$desc|default='页面描述'}">


{/block}

{block name="mycss"}
{load href="__BACKEND__static/css/" /}
<style type="text/css">
    .box-footer {
        border-top-left-radius: 0;
        border-top-right-radius: 0;
        border-bottom-right-radius: 3px;
        border-bottom-left-radius: 3px;
        border-top: 1px solid #f4f4f4;
        padding: 10px;
        background-color: #ffffff;
    }

    .box-footer {
        padding-top: 30px;
    }
    .box-footer:before {
        content: " ";
        display: table;
    }
    .box-footer:after {
        clear: both;
    }

    .clearfix:before, .clearfix:after,{
        display: table;
        content: " ";
    }

    .clearfix:after {
        clear: both;
    }

    .pagination {
  display: inline-block;
  padding-left: 0;
  margin: 20px 0;
  border-radius: 4px;
}
.pagination > li {
  display: inline;
}
.pagination > li > a,
.pagination > li > span {
  position: relative;
  float: left;
  padding: 6px 12px;
  margin-left: -1px;
  line-height: 1.42857143;
  color: #337ab7;
  text-decoration: none;
  background-color: #fff;
  border: 1px solid #ddd;
}
.pagination > li:first-child > a,
.pagination > li:first-child > span {
  margin-left: 0;
  border-top-left-radius: 4px;
  border-bottom-left-radius: 4px;
}
.pagination > li:last-child > a,
.pagination > li:last-child > span {
  border-top-right-radius: 4px;
  border-bottom-right-radius: 4px;
}
.pagination > li > a:hover,
.pagination > li > span:hover,
.pagination > li > a:focus,
.pagination > li > span:focus {
  z-index: 2;
  color: #23527c;
  background-color: #eee;
  border-color: #ddd;
}
.pagination > .active > a,
.pagination > .active > span,
.pagination > .active > a:hover,
.pagination > .active > span:hover,
.pagination > .active > a:focus,
.pagination > .active > span:focus {
  z-index: 3;
  color: #fff;
  cursor: default;
  background-color: #337ab7;
  border-color: #337ab7;
}
.pagination > .disabled > span,
.pagination > .disabled > span:hover,
.pagination > .disabled > span:focus,
.pagination > .disabled > a,
.pagination > .disabled > a:hover,
.pagination > .disabled > a:focus {
  color: #777;
  cursor: not-allowed;
  background-color: #fff;
  border-color: #ddd;
}
.pagination-lg > li > a,
.pagination-lg > li > span {
  padding: 10px 16px;
  font-size: 18px;
  line-height: 1.3333333;
}
.pagination-lg > li:first-child > a,
.pagination-lg > li:first-child > span {
  border-top-left-radius: 6px;
  border-bottom-left-radius: 6px;
}
.pagination-lg > li:last-child > a,
.pagination-lg > li:last-child > span {
  border-top-right-radius: 6px;
  border-bottom-right-radius: 6px;
}
.pagination-sm > li > a,
.pagination-sm > li > span {
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
}
.pagination-sm > li:first-child > a,
.pagination-sm > li:first-child > span {
  border-top-left-radius: 3px;
  border-bottom-left-radius: 3px;
}
.pagination-sm > li:last-child > a,
.pagination-sm > li:last-child > span {
  border-top-right-radius: 3px;
  border-bottom-right-radius: 3px;
}
    .pull-right {
        float: right;
    }


</style>
{/block}

{block name="content"}
<section class="Hui-article-box">
    <nav class="breadcrumb"><i class="Hui-iconfont">&#xe67f;</i> 首页 <span class="c-gray en">&gt;</span> 产品管理 <span class="c-gray en">&gt;</span> 产品列表 <a class="btn btn-success radius r" style="line-height:1.6em;margin-top:3px" href="javascript:location.replace(location.href);" title="刷新" ><i class="Hui-iconfont">&#xe68f;</i></a></nav>
    <div class="Hui-article">
        <div>
            <div class="pd-20">
                <div class="text-c"> 
                    {literal}
                    <input type="text" name="" id="keyword" placeholder=" 产品名称" style="width:250px" class="input-text">
                    <button name=""  class="btn btn-success" id="search_btn" type="submit"><i class="Hui-iconfont">&#xe665;</i> 搜产品</button>
                    {/literal}
                </div>
                <div class="cl pd-5 bg-1 bk-gray mt-20"> <span class="l"><button class="btn btn-danger radius" id="deleteItem"><i class="Hui-iconfont">&#xe6e2;</i> 删除</button><button class="btn btn-primary radius" href="#" id="addItem"><i class="Hui-iconfont">&#xe600;</i> 增加产品</button></span> <span class="r">共有数据：<strong>54</strong> 条</span> </div>
                <div class="mt-20">
                  <form action="" method="post" class="form form-horizontal">
                    {:token()}
                    <input type="hidden" name="express_id" value="{$express_id}">
                    <div class="row cl">
                      <div class="col-xs-3">
                        <p>产品id</p>
                      </div>
                      <div class="col-xs-3">
                        <p>产品型号</p>
                      </div>
                      <div class="col-xs-3">
                        <p>买入价格</p>
                      </div>
                      <div class="col-xs-3">
                        <p>数量</p>
                      </div>
                    </div>
                    <div class="row cl last">
                       <div class="col-xs-3">
                         <input type="text" class="input-text radius" name="item_id[]">
                       </div>
                       <div class="col-xs-3">
                         <input type="text" class="input-text radius" name="attr_symbol_path[]">
                       </div>
                       <div class="col-xs-3">
                         <input type="text" class="input-text radius" name="inprice[]">
                       </div>
                       <div class="col-xs-3">
                         <input type="text" class="input-text radius" name="number[]">
                       </div>
                    </div>
                    <div class="row cl">
                      <div class="col-xs-offset-10">
                      <button type="submit" class="btn btn-primary radius">提交</button>
                      </div>
                    </div>
                  </form>
                   
                </div>
            </div>
        </div>

    </div>
</section>
{/block}

{block name="myjs"}
<script type="text/javascript">
  $("#addItem").click(function(){
    var html = '<div class="row cl last">'+ '<div class="col-xs-3">'+
                         '<input type="text" class="input-text radius" name="item_id[]">'+
                       '</div>'+
                       '<div class="col-xs-3">'+
                         '<input type="text" class="input-text radius" name="attr_symbol_path[]">'+
                       '</div>'+
                       '<div class="col-xs-3">'+
                         '<input type="text" class="input-text radius" name="inprice[]">'+
                       '</div>'+
                       '<div class="col-xs-3">'+
                         '<input type="text" class="input-text radius" name="number[]">'+
                       '</div>'+
                    '</div>';
    $('.last').removeClass("last").after(html);
  });

  $('#deleteItem').click(function(){ 
    if ($('.row').length > 2 ) {
        $('.last').remove();
        $('.row').last().prev().addClass('last');       
    }
  });

  $('#search_btn').click(function(){
    var key = $('#keyword').val();
    $.ajax({
      type: 'get',
      url: "{:url('backend/shopping_records/search_items')}",
      data: 'key='+key,
      success: function(data) {
        var datas = eval('('+data+')');
        console.log(data);
        $('#item_list').remove();
        var out = '<div id="item_list">';
        if (datas == "" || datas == undefined || datas == null){
          out += '<p>无结果</p></div>';
        } else {
          $.each(datas,function(i,item){
            out += '<div class="album-item col-xs-3" style="height:200px;" data-id="'+item['id']+'"><div class="album-img"><img src="/static/customer/items/'+item['title']+'/'+item['pic_url_01']+'" ></div><div class="album-title">'+item['title']+'<span class="c-999">（'+item['id']+'）</span></div></div>'
          });
          out += '</div>';
        }
        $('.form').after(out);
      }
    });
  });
  $(document).on('click','.album-item',function(){
    var id = $(this).attr("data-id");
    $.ajax({
      type: 'get',
      url: "{:url('backend/shopping_records/search_attr')}",
      data: 'key='+id,
      success: function(data) {
        var datas = eval('('+data+')');
        console.log(data);
        $('#item_list').remove();
        var out = '<div id="item_list">';
        if (datas == "" || datas == undefined || datas == null){
          out += '<p>无结果</p></div>';
        } else {
          $.each(datas,function(i,attr){
            out += '<p>'+i+':'+attr+'</p>';
          });
          out += '</div>';
        }
        $('.form').after(out);
      }
    });
  })
</script>
{/block}
